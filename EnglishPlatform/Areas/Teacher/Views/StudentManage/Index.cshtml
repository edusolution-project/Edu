@{

    Layout = "~/Views/Shared/_LayoutTeacher_NewUI.cshtml";
    ViewData["Title"] = "Student Management";
    var listGrade = ViewBag.Grade as List<BaseCustomerEntity.Database.GradeEntity>;
    var listSubject = ViewBag.Subject as List<BaseCustomerEntity.Database.SubjectEntity>;
    var listTeacher = ViewBag.Teacher as List<BaseCustomerEntity.Database.TeacherEntity>;
    var user = ViewBag.User as string;
    var hasManageRole = (bool)(ViewBag.Managable ?? false);
}

<script src="../libs/quill-editor/quill.min.js"></script>
<script src="../libs/quill-editor/quill-vue.min.js"></script>
<link href="../libs/quill-editor/quill.core.css" rel="stylesheet">
<link href="../libs/quill-editor/quill.snow.css" rel="stylesheet">
<link href="../libs/quill-editor/quill.bubble.css" rel="stylesheet">

<script>
    setActiveMenu("student");
</script>

<section class="module" id="dashboard_content">
    <div class="card-header">
        <div class="flex border-b padding-b25 justify-content-between">
            <div class="flex">
                <div class="box filter-box w-152">
                    <select name="">
                        <option value="">Môn học</option>
                    </select>
                </div>
                <div class="box filter-box w-152">
                    <select name="">
                        <option value="">Cấp độ</option>
                    </select>
                </div>
                <div class="w-250 box filter-box">
                    <select name="">
                        <option value="">Giáo viên</option>
                    </select>
                </div>
            </div>
            <b-button v-b-modal.modal_event class="btn-addevent btn-student"><i class="ti-plus"></i></b-button>
        </div>
    </div>
    <div class="card-body">
        <table id="ed_table" class="table">
            <thead>
                <tr>
                    <th v-for="(field,k) in fields">{{field.label}}</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,k) in tableData" v-if="item.id > 0">
                    <td>{{k+1}}</td>
                    <td><a href="/teacher/student_detail.html" :title="item.name">{{item.name}}</a></td>
                    <td>{{item.email}}</td>
                    <td>{{item.phone}}</td>
                    <td v-bind:class="{good : (item.per > 50)}">{{item.per+'%'}}</td>
                    <td>{{item.last_update}}</td>
                    <td v-bind:class="{good : (item.score > 5)}">{{item.score + ' điểm'}}</td>
                    <td><button class="btn-act btn-trash"><i class="ti-trash"></i></button></td>
                </tr>
            </tbody>
        </table>
        <div class="box margin-t20 flex">
            <div class="paging-view">
                Hiển thị:
                <select v-model="view">
                    <option value="10">10 kết quả</option>
                    <option value="20">20 kết quả</option>
                    <option value="30">30 kết quả</option>
                </select>
            </div>
            <div class="page-control">
                <div class="right">
                    <b-pagination v-model="page"
                                  :total-rows="total_record"
                                  :per-page="pageSize"
                                  v-on:input="getData()"></b-pagination>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        Vue.use(VueQuillEditor)
        new Vue({
            el: "#main",
            mounted() {
                this.getNews()
            },
            components: {
                LocalQuillEditor: VueQuillEditor.quillEditor
            },
            data: {
                editorOption: {
                    theme: 'snow'
                },
                lessons: {
                    id: 0,
                    lesson_name: '',
                    subject_name: '',
                    level: '',
                    content: ''
                },
                fields: [
                    {
                        key: 'stt',
                        label: '#'
                    },
                    {
                        key: 'name',
                        label: 'Họ tên'
                    },
                    {
                        key: 'email',
                        label: 'Email'
                    },
                    {
                        key: 'phone',
                        label: 'SĐT'
                    },
                    {
                        key: 'per',
                        label: 'Tiến độ'
                    },
                    {
                        key: 'last_update',
                        label: 'Lần cuối'
                    },
                    {
                        key: 'score',
                        label: 'Kết quả'
                    },
                    {
                        key: 'actions',
                        label: 'Tác vụ'
                    }
                ],
                tableData: [
                    {
                        id: 1,
                        name: 'Huong Ho',
                        email: 'lanhuongho0507@gmail.com',
                        phone: '0983750705',
                        per: 23,
                        last_update: '08:45 02/11/2019',
                        score: 4,
                    },
                    {
                        id: 2,
                        name: 'Nguyễn Thị Quỳnh Đan',
                        email: 'quynhdanhanu@gmail.com',
                        phone: '0983750705',
                        per: 51,
                        last_update: '08:45 02/11/2019',
                        score: 6,
                    },
                ],
                list_news: [
                    {
                        title: 'Đã đến lúc HLV Park',
                        description: 'Đây là lúc để HLV Park giải bài toán khó nhất của ông',
                        thumbnail: '/pictures/news1.png'
                    },
                    {
                        title: 'HLV Park: Có khi p',
                        description: 'Đây là lúc để HLV Park giải bài toán khó nhất của ông',
                        thumbnail: '/pictures/news2.png'
                    },
                    {
                        title: 'Tiến Dũng và Văn Toả',
                        description: 'Đây là lúc để HLV Park giải bài toán khó nhất của ông',
                        thumbnail: '/pictures/news3.png'
                    },
                ],
                week: '',
                view: 10,
                page: 1,
                pageSize: 10,
                total_record: 22,
                student_name: ''
            },
            watch: {
                lessons: function (val) {
                    console.log(val);
                }
            },
            methods: {
                getData() {
                    let _data = []

                    this.tableData = _data
                },
                getNews() {
                    // tương tự như trên
                },
                destroy(id) {
                    this.tableData.forEach(function (item, k) {
                        if (item.id == id) {
                            item.id = 0
                        }
                    })
                    let _data = this.tableData.filter(function (a) {
                        return a.id > 0
                    })
                    this.tableData = _data
                },
                toggleState(obj) {
                    this.tableData.forEach(function (item, k) {
                        if (item.id === obj.id) {
                            item.state = !item.state
                        }
                    })
                },
                showInfo(obj) {
                    // console.log(obj)
                    this.lessons = obj
                    this.$bvModal.show('modal_event')
                }
            }
        });

    </script>
}

@section Modals{
    <b-modal id="modal_event" centered title="Thêm học viên">
        <b-col class="form-group">
            <label for="">Học viên</label>
            <input type="text" v-model="student_name" class="form-control" placeholder="Nhập để tìm kiếm">
        </b-col>
        <template v-slot:modal-footer="{ ok, cancel}">
            <b-button variant="success">Lưu</b-button>
            <b-button variant="danger">Huỷ</b-button>
        </template>
    </b-modal>
}